"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[551],{4551:(P,g,n)=>{n.r(g),n.d(g,{HistoryModule:()=>_,MY_FORMATS:()=>y});var T=n(4521),p=n(7423),v=n(4834),h=n(5245),A=n(2181),b=n(5899),D=n(4847),C=n(4999),Y=n(1244),H=n(4466),S=n(7579),Z=n(2722),s=n(3075),F=n(5439),l=n.n(F),I=n(1064),M=n.n(I),t=n(5e3),N=n(9122),J=n(4880),U=n(1816),j=n(2340),E=n(520),L=n(8951);let O=(()=>{class i{constructor(e,o){this._httpClient=e,this._authService=o}getHistoryInfo(e,o){const a=(0,U.Z)(this._authService.user);return this._httpClient.post(`${j.N.API_URL}/Transacciones_App/sel_comercio`,{nu_id_comercio:a.nu_id_comercio,nu_id_comercio_app:a.nu_id_comercio_app,dt_fec_inicio:e,dt_fec_final:o})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(E.eN),t.LFG(L.e))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var w=n(8734),u=n(7322),c=n(6856),d=n(9808);function R(i,r){if(1&i){const e=t.EpF();t.TgZ(0,"div",29),t.TgZ(1,"div",30),t.TgZ(2,"div",31),t.TgZ(3,"span",32),t._uU(4),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.qZA(),t.qZA(),t.TgZ(7,"div",33),t.TgZ(8,"span"),t._uU(9),t.qZA(),t.qZA(),t.qZA(),t.TgZ(10,"div",34),t.TgZ(11,"div"),t.TgZ(12,"span",35),t._uU(13,"Comisi\xf3n:"),t.qZA(),t.TgZ(14,"span",36),t._uU(15),t.ALo(16,"number"),t.qZA(),t.qZA(),t.TgZ(17,"span",37),t._uU(18),t.ALo(19,"number"),t.qZA(),t.TgZ(20,"button",38),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit;return t.oxw(2).printInvoice(a.nu_id_trx_app)}),t._UZ(21,"mat-icon",39),t.qZA(),t.qZA(),t._UZ(22,"mat-divider"),t.qZA()}if(2&i){const e=t.oxw().$implicit;t.xp6(4),t.hij(" N\xb0 Operaci\xf3n: ",e.nu_id_trx_app," "),t.xp6(2),t.hij(" ",e.vc_desc_grupo_producto," "),t.xp6(3),t.Oqu(e.dt_fecha),t.xp6(6),t.hij(" S/ ",t.xi3(16,5,e.nu_valor_comision,".2-2")," "),t.xp6(3),t.hij(" S/ ",t.xi3(19,8,e.nu_precio,".2-2")," ")}}function q(i,r){if(1&i&&(t.TgZ(0,"div",27),t.YNc(1,R,23,11,"div",28),t.qZA()),2&i){const e=t.oxw().ngIf;t.xp6(1),t.Q6J("ngIf",e.length>0)}}function Q(i,r){1&i&&(t.TgZ(0,"div",40),t.TgZ(1,"span",41),t._uU(2," No se encontraron registros para la fecha indicada "),t.qZA(),t.qZA())}function B(i,r){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,q,2,1,"div",25),t.YNc(2,Q,3,0,"div",26),t.qZA()),2&i){const e=r.ngIf;t.xp6(1),t.Q6J("ngForOf",e),t.xp6(1),t.Q6J("ngIf",e.length<1)}}const G=[{path:"",component:(()=>{class i{constructor(e,o,a,m){this._fuseNavigationService=e,this._fuseMediaWatcherService=o,this.historyService=a,this._printInvoiceService=m,this.range=new s.cw({trxStartDate:new s.NI,trxEndDate:new s.NI}),this._unsubscribeAll=new S.x,this.myFilter=f=>(f||l()())<l()()}ngOnInit(){this._fuseMediaWatcherService.onMediaChange$.pipe((0,Z.R)(this._unsubscribeAll)).subscribe(({matchingAliases:e})=>{this.isScreenSmall=!e.includes("md")}),this.changeDates(0)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}trackByFn(e,o){return o.id||e}toggleNavigation(e){const o=this._fuseNavigationService.getComponent(e);o&&this.isScreenSmall&&o.toggle()}getTransactions(){this.range.get("trxEndDate").value&&(this.transactions=this.historyService.getHistoryInfo(this.formatDate(this.range.get("trxStartDate").value),this.formatDate(this.range.get("trxEndDate").value)).pipe((0,Z.R)(this._unsubscribeAll)))}selectFirstDate(e){const o=l()(e).add(7,"days");this.maxDate=o}selectEndDate(){this.range.get("trxEndDate").value&&this.getTransactions()}formatDate(e){return l()(e).format("YYYY-MM-DD")}changeDates(e){this.range.get("trxStartDate").setValue(l()().subtract(e,"days")),this.range.get("trxEndDate").setValue(l()()),this.maxDate=l()(new Date),this.getTransactions()}printInvoice(e){this._printInvoiceService.getInvoice(e).subscribe(o=>{M()({printable:o.vc_ruta_archivo,type:"pdf",showModal:!0})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(N.Jf),t.Y36(J.T),t.Y36(O),t.Y36(w.V))},i.\u0275cmp=t.Xpm({type:i,selectors:[["history"]],decls:33,vars:9,consts:[[1,"flex","flex-col","flex-auto","w-full",2,"background-color","#7c66f7"],[1,"flex-col","flex-auto","bg-card","relative","p-5","md:p-10",2,"border-top-left-radius","3rem !important","border-bottom-left-radius","3rem !important"],[1,"p-5","md:p-0"],["mat-icon-button","",1,"absolute","md:hidden","top-8","left-8",3,"click"],[3,"svgIcon"],[1,"ml-10","-mt-1.5","md:ml-0","md:mt-0","text-3xl","font-bold"],[1,"grid","grid-cols-1","md:grid-cols-2","my-4"],[1,"min-h-40"],[1,"mb-4","flex","justify-between"],["mat-raised-button","","color","primary",1,"w-28","ml-2","sm:ml-4","md:w-60","md:mx-1","text-sm","md:text-base",3,"click"],["mat-raised-button","","color","primary",1,"w-28","ml-2","md:w-60","md:mx-1","text-sm","md:text-base",3,"click"],[1,"flex","items-center","justify-between"],[1,"text-lg","font-bold","mr-1"],[1,"flex","items-center","border-2","border-[#7c66f7]","p-1","w-full","sm:w-80","md:w-full","lg:w-80"],[1,"custom","w-full"],[3,"formGroup","rangePicker","dateFilter","max"],["matStartDate","","formControlName","trxStartDate","placeholder","Fecha Inicio",3,"dateChange"],["matEndDate","","formControlName","trxEndDate","placeholder","Fecha Final",3,"dateChange"],["matSuffix","",3,"for"],["maxRange","7"],["picker",""],[1,"mb-4","flex","justify-center"],["mat-raised-button","","color","primary",1,"mt-2","w-full","sm:w-60","sm:ml-4","md:w-60","md:ml-0",3,"click"],[1,"border-2","rounded-lg","p-2.5","sm:p-5"],[4,"ngIf"],["class","my-4",4,"ngFor","ngForOf"],["class","flex justify-center",4,"ngIf"],[1,"my-4"],["class","mb-4",4,"ngIf"],[1,"mb-4"],[1,"flex","justify-between","mb-1"],[1,"flex","flex-col"],[1,"font-semibold","text-[#7c66f7]"],[1,"text-sm"],[1,"flex","justify-between","mb-4"],[1,"mr-1"],[1,"font-semibold"],[1,"font-semibold","text-xl"],[1,"ml-2",3,"click"],["svgIcon","heroicons_outline:printer"],[1,"flex","justify-center"],[1,"font-semibold","text-lg"]],template:function(e,o){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t.TgZ(3,"button",3),t.NdJ("click",function(){return o.toggleNavigation("mainNavigation")}),t._UZ(4,"mat-icon",4),t.qZA(),t.TgZ(5,"div",5),t._uU(6," Historial "),t.qZA(),t.TgZ(7,"div",6),t.TgZ(8,"div",7),t.TgZ(9,"div",8),t.TgZ(10,"button",9),t.NdJ("click",function(){return o.changeDates(7)}),t._uU(11," \xdaltima semana "),t.qZA(),t.TgZ(12,"button",9),t.NdJ("click",function(){return o.changeDates(3)}),t._uU(13," \xdaltimos 3 d\xedas "),t.qZA(),t.TgZ(14,"button",10),t.NdJ("click",function(){return o.changeDates(0)}),t._uU(15," Hoy "),t.qZA(),t.qZA(),t.TgZ(16,"div",11),t.TgZ(17,"span",12),t._uU(18,"Operaciones de mis clientes"),t.qZA(),t.TgZ(19,"div",13),t.TgZ(20,"mat-form-field",14),t.TgZ(21,"mat-date-range-input",15),t.TgZ(22,"input",16),t.NdJ("dateChange",function(m){return o.selectFirstDate(m.value)}),t.qZA(),t.TgZ(23,"input",17),t.NdJ("dateChange",function(){return o.selectEndDate()}),t.qZA(),t.qZA(),t._UZ(24,"mat-datepicker-toggle",18),t._UZ(25,"mat-date-range-picker",19,20),t.qZA(),t.qZA(),t.qZA(),t.TgZ(27,"div",21),t.TgZ(28,"button",22),t.NdJ("click",function(){return o.changeDates(0)}),t._uU(29," Reiniciar Fechas "),t.qZA(),t.qZA(),t.TgZ(30,"div",23),t.YNc(31,B,3,2,"div",24),t.ALo(32,"async"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const a=t.MAs(26);t.xp6(4),t.Q6J("svgIcon","heroicons_outline:menu"),t.xp6(17),t.Q6J("formGroup",o.range)("rangePicker",a)("dateFilter",o.myFilter)("max",o.maxDate),t.xp6(3),t.Q6J("for",a),t.xp6(7),t.Q6J("ngIf",t.lcZ(32,7,o.transactions))}},directives:[p.lW,h.Hw,u.KE,c.wx,s.JL,s.sg,c.zY,s.Fj,s.JJ,s.u,c.By,c.nW,u.R9,c._g,d.O5,d.sg,v.d],pipes:[d.Ov,d.JJ],styles:[".custom.mat-form-field.mat-form-field-appearance-fill .mat-form-field-wrapper{margin-bottom:0!important}.custom.mat-form-field.mat-form-field-appearance-fill .mat-form-field-wrapper .mat-form-field-flex{background-color:#fcfbff!important;border-width:0!important}\n"],encapsulation:2,changeDetection:0}),i})()}];var V=n(3170),x=n(508);const y={parse:{dateInput:"DD/MM/YYYY"},display:{dateInput:"DD/MM/YYYY",monthYearLabel:"MMMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MM YYYY"}};let _=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[{provide:x.sG,useValue:y},{provide:x.Ad,useValue:"es-ES"}],imports:[[T.Bz.forChild(G),H.m,p.ot,v.t,h.Ps,A.Tx,b.Cv,D.JX,C.p0,Y.X,u.lN,c.FA,V.Yd]]}),i})()}}]);